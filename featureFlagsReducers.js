"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};var _a;Object.defineProperty(exports,"__esModule",{value:true});exports.resetFeatures=exports.editFeature=exports.loadFeatureFlagsRedux=exports.featureFlagSlice=void 0;var toolkit_1=require("@reduxjs/toolkit");var featureFlags_1=require("./featureFlags");var initialState={features:[],persist:false};exports.featureFlagSlice=(0,toolkit_1.createSlice)({name:"featureflag",initialState:initialState,reducers:{loadFeatureFlagsRedux:function(state,action){var _a=action.payload,features=_a.features,overrides=_a.overrides,persist=_a.persist,reset=_a.reset;var newFeatures=reset||!persist?[]:__spreadArray([],state.features,true);(0,featureFlags_1.featuresWithOverrides)(features,overrides).forEach(function(feature){var featureIndex=newFeatures.findIndex(function(f){return f.id===feature.id});if(featureIndex===-1){newFeatures.push(__assign(__assign({},feature),{original:feature.active}))}else{newFeatures[featureIndex].original=feature.active}});state.persist=persist;state.features=newFeatures},editFeature:function(state,action){var newFeatures=__spreadArray([],state.features,true);var featureIndex=newFeatures.findIndex(function(flag){return flag.id===action.payload.id});newFeatures[featureIndex].active=action.payload.active;state.features=newFeatures},resetFeatures:function(state){var features=__spreadArray([],state.features,true);var newFeatures=features.map(function(feature){return __assign(__assign({},feature),{active:feature.original})});state.features=newFeatures}}});exports.loadFeatureFlagsRedux=(_a=exports.featureFlagSlice.actions,_a.loadFeatureFlagsRedux),exports.editFeature=_a.editFeature,exports.resetFeatures=_a.resetFeatures;exports.default=exports.featureFlagSlice.reducer;